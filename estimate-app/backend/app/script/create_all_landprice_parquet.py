import pandas as pd
import geopandas as gpd
from shapely.geometry import Point
import os
# 建物用途ごとの倍率（地価に掛ける目安）
usage_factors = {
   "ビル": 1.5,
   "住宅": 1.0,
   "オフィス": 1.3,
   "工場": 0.9,
   "学校": 1.1,
   "商業施設": 1.4,
   "病院": 1.2,
   "その他": 1.0
}
# 保存先
BASE_DIR = os.path.abspath(os.path.join(os.path.dirname(__file__), ".."))
DATA_DIR = os.path.join(BASE_DIR, "data", "land_price")
SPLIT_DIR = os.path.join(DATA_DIR, "split")
os.makedirs(SPLIT_DIR, exist_ok=True)
# 都道府県リストと中心座標（ダミー）
pref_data = [
   ("北海道", 43.06417, 141.34694),
   ("青森県", 40.82444, 140.74),
   ("岩手県", 39.70361, 141.1525),
   ("宮城県", 38.26889, 140.87222),
   ("秋田県", 39.71861, 140.1025),
   ("山形県", 38.24056, 140.36333),
   ("福島県", 37.75, 140.46778),
   ("茨城県", 36.34139, 140.44667),
   ("栃木県", 36.56583, 139.88361),
   ("群馬県", 36.39111, 139.06083),
   ("埼玉県", 35.85694, 139.64889),
   ("千葉県", 35.60472, 140.12333),
   ("東京都", 35.68944, 139.69167),
   ("神奈川県", 35.44778, 139.6425),
   ("新潟県", 37.90222, 139.02361),
   ("富山県", 36.69528, 137.21139),
   ("石川県", 36.59444, 136.62556),
   ("福井県", 36.06528, 136.22194),
   ("山梨県", 35.66389, 138.56833),
   ("長野県", 36.65139, 138.18111),
   ("岐阜県", 35.39111, 136.72222),
   ("静岡県", 34.97694, 138.38306),
   ("愛知県", 35.18028, 136.90667),
   ("三重県", 34.73028, 136.50861),
   ("滋賀県", 35.00444, 135.86833),
   ("京都府", 35.02139, 135.75556),
   ("大阪府", 34.68639, 135.52),
   ("兵庫県", 34.69139, 135.18306),
   ("奈良県", 34.68528, 135.83278),
   ("和歌山県", 34.22611, 135.1675),
   ("鳥取県", 35.50361, 134.23833),
   ("島根県", 35.47222, 133.05056),
   ("岡山県", 34.66167, 133.935),
   ("広島県", 34.39639, 132.45944),
   ("山口県", 34.18583, 131.47139),
   ("徳島県", 34.06583, 134.55944),
   ("香川県", 34.34028, 134.04333),
   ("愛媛県", 33.84167, 132.76611),
   ("高知県", 33.55972, 133.53111),
   ("福岡県", 33.60639, 130.41806),
   ("佐賀県", 33.24944, 130.29889),
   ("長崎県", 32.74472, 129.87361),
   ("熊本県", 32.78972, 130.74167),
   ("大分県", 33.23806, 131.6125),
   ("宮崎県", 31.91111, 131.42389),
   ("鹿児島県", 31.56028, 130.55806),
   ("沖縄県", 26.2125, 127.68111),
]
# スプリット保存用ループ
for pref, lat, lon in pref_data:
   base_price = int(30000 + hash(pref) % 30000)  # ダミー地価（円/㎡）
   records = []
   for usage, factor in usage_factors.items():
       records.append({
           "都道府県名": pref,
           "用途": usage,
           "地価目安": base_price,
           "用途別価格": int(base_price * factor),
           "倍率": factor,
           "geometry": Point(lon, lat)
       })
   gdf = gpd.GeoDataFrame(records, crs="EPSG:4326")
   out_file = os.path.join(SPLIT_DIR, f"{pref}.parquet")
   gdf.to_parquet(out_file, engine="pyarrow")
   print(f"✅ {pref} → {out_file}")
print(f"\n✅ 47都道府県すべての用途別地価ファイルを保存完了！ → {SPLIT_DIR}")